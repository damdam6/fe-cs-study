## 웹 성능 최적화

### ✅ INDEX

[웹 성능 최적화의 필요성](#웹-성능-최적화의-필요성)

[웹 프론트엔드 성능 최적화 측정 도구](#웹-프론트엔드-성능-최적화-측정-도구)

[Lighthouse 란?](#lighthouse-란)

[웹 성능 지표](#웹-성능-지표)

[웹 성능 개선 방안](#웹-성능-개선-방안)

[접근성](#접근성)

[SEO (검색 엔진 최적화)](#seo-검색-엔진-최적화)

### 웹 성능 최적화의 필요성

- 긍정적인 사용자 경험 제공
- 사용자 이탈률 감소
- 검색 엔진 최적화

### 웹 프론트엔드 성능 최적화 측정 도구

- 구글의 Page Speed Insights, Lighthouse 등이 있다.
- 로컬 개발 환경에서는 크롬 브라우저의 `Lighthouse`를 활용해 성능을 측정하고, 측정 결과에 따라 개선점을 찾는 것이 일반적이다.

### Lighthouse 란?

- Google Chrome에서 제공하는, 웹앱의 품질 개선에 도움을 주는 자동화 도구
- 성능, 접근성, SEO 등 사이트에 대한 전반적인 진단을 할 수 있습니다.

### 웹 성능 지표

> Lighthouse 의 6가지 Metric

- FCP (First Contentful Paint)
  - 초기 DOM 콘텐츠를 렌더링하는데 걸리는 시간을 측정한다.
  - 첫번째 텍스트 또는 이미지가 표시되는 시간을 가리킨다.
- TTI (Time to Interactive)
  - 사용자가 페이지와 완전하게 상호작용할 수 있을 때까지 걸리는 시간
  - e.g. 이벤트 핸들러가 가장 눈에 띄는 페이지 요소에 등록되는 시점
- TBT (Total Blocking Time)
  - 마우스 클릭, 키보드 입력과 같은 사용자 입력에 페이지가 응답하지 못하도록 차단된 총 시간
  - FCP ~ TTI 사이의 모든 Long Task 블로킹 타임을 추가하여 계산
- SI (Speed Index)
  - 콘텐츠가 시각적으로 표시되는 진행 속도를 측정한다.
  - 리로드 되는 페이지의 비디오를 캡쳐하여 프레임 간의 속도를 계산한다.
- LCP (Largest Contentful Paint)\
  - 가장 큰 콘텐츠를 렌더링하는 데 걸리는 시간
  - 보통 중요한 콘텐츠일수록 크기가 크기 때문에, Lighthouse는 해당 점수에 높은 가중치(25%)를 부여하여 계산한다.
  - LCP로 간주되는 요소 : `<img>`, `<video>`, `<svg>` 내부 image 요소, background-image 속성의 url()로 로드되는 요소, block 레벨 요소
- CLS (Cumulative Layout Shift)
  - 사용자가 예상치 못한 레이아웃 이동을 경험하는 것에 대한 점수

+) Lighthouse의 지표별 가중 평균

| 지표 | 가중치 |
| ---- | ------ |
| FCP  | 15%    |
| SI   | 15%    |
| LCP  | 25%    |
| TTI  | 15%    |
| TBT  | 25%    |
| CLS  | 5%     |

### 웹 성능 개선 방안

- 공통
  - JS 실행 시간 단축
- SI 점수를 높이기 위해
  - 메인 스레드 작업 최소화
  - 폰트 로드되는 중에도 텍스트 계속 표시되도록 처리
- TBT 점수를 높이기 위해 (= Long Task 근본적으로 제거)
  - 코드 분할로 JS Payload 감소시키기
  - 사용하지 않는 코드 삭제

### 접근성

\*\*[웹 접근성 체크리스트](http://210.116.77.11/pbGuide/guide/html/wah/wahChecklst.html) 참고

- 준수사항 및 예시
  - 인식의 용이성 : 적절한 대체텍스트 등을 제공하고, 콘텐츠 간 색상 대비를 주어 가독성 좋게 구성하는 등
  - 운용의 용이성 : 모든 기능은 키보드만으로 사용할 수 있어야 하고, 페이지, 프레임, 콘텐츠 블록 에 적절한 제목을 부여하는 등
  - 이해의 용이성 : 레이블 제공 등
  - 견고성 : 마크업 오류가 없어야 하고, 웹 애플리케이션 접근성을 준수하는 등

### SEO (검색 엔진 최적화)

- 검색 엔진은 웹을 크롤링하면서 페이지에서 페이지로 링크를 따라가고, 찾은 콘텐츠의 색인을 생성한다. 검색 결과에 보이는 것은 바로 그 색인으로 된 콘텐츠이다.
- 크롤러는 일정 규칙을 따르므로, SEO를 진행하며 해당 규칙을 밀접하게 따라야 검색 엔진 상단에 노출시킬 수 있다.

- 최적화 종류
  - 기술적 : 웹 사이트 탐색 시, 색인하길 원했던 콘텐츠만 크롤러가 긁어갈 수 있도록 시맨틱 HTML을 사용해야 한다.
  - 콘텐츠 작성 : 방문자층에 맞는 언어로 콘텐츠를 작성하고, 이미지와 더불어 텍스트를 사용해 크롤러가 주제를 이해할 수 있도록 해야 한다.
  - 인기도 : 다른 유명 사이트에서 해당 사이트를 링크시 더 많은 트래픽을 받는다.
- 최적화 방안
  - 크롤링 및 색인 생성
    - 검색 결과에 표시하려면 크롤러가 앱에 액세스할 수 있어야 한다.
    - 따라서 검색로봇에게 사이트 및 웹페이지를 수집할 수 있도록 허용하거나 제한하는 국제 권고안인 `robots.txt` 가 루트 디렉토리에 있어야 한다.
  - alt 속성을 작성하여 크롤러로 하여금 이미지를 이해할 수 있게 돕는다.
  - 캐노니컬 태그 사용
    - URL 주소는 다르지만 동일한 내용의 중복된 페이지가 있을 때 페이지에 코드를 삽입하여 검색엔진에 대표가 되는 URL 주소를 알려주는 역할을 하는 태그
    - 페이지 중요도 분산을 막고, 중복되는 다른 페이지들을 덜 크롤링하는 것을 방지한다.
    ```html
    <!-- 예시 -->
    <head>
      <link rel="canonical" href="https://www.mysite.com/shop" />
    </head>
    ```

<br>

### 👀 참고자료

https://developer.mozilla.org/ko/docs/Glossary/SEO

https://blog.soomgo.com/posts/6673bb8a52107866fb86a76d

https://devocean.sk.com/search/techBoardDetail.do?ID=164863

https://devocean.sk.com/blog/techBoardDetail.do?ID=165395
